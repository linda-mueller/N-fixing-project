theme_minimal()+
labs(y="Probability of N-fixing plant species")+
xlab("Distance [km]")+
theme(axis.text.y=element_text(size=30))+
theme(axis.text.x=element_text(size=30))+
theme(axis.title.y=element_text(size=30))+
theme(axis.title.x=element_text(size=30))+
colo+
filo+
ylim(0,1)+
theme(legend.key.size = unit(1, 'cm'),      #change legend key size
legend.key.height = unit(1, 'cm'),    #change legend key height
legend.key.width = unit(1, 'cm'),     #change legend key width
legend.title = element_text(size=34), #change legend title font size
legend.text = element_text(size=30),  #change legend text font size
legend.position = "none")       #change legend position
areadist_oc_pres_ntz_plot
#plot the area distance interaction position=position_jitterdodge(dodge.width = 1)
areadist_oc_pres_ntz_plot<- ggplot(pdat, aes(x = dist, y = fit, fill=size, color=size))+
geom_line() +
geom_ribbon(aes(ymin=fit-se.fit, ymax=fit+se.fit), alpha=0.4)+
geom_point(data = gdat.isl.ntz,aes(x=dist,y=presence, color=areasize, fill=size),alpha=0.7,show.legend = FALSE)+
theme_minimal()+
labs(y="Probability of N-fixing plant species")+
xlab("Distance [km]")+
theme(axis.text.y=element_text(size=30))+
theme(axis.text.x=element_text(size=30))+
theme(axis.title.y=element_text(size=30))+
theme(axis.title.x=element_text(size=30))+
colo+
filo+
ylim(0,1)+
theme(legend.key.size = unit(1, 'cm'),      #change legend key size
legend.key.height = unit(1, 'cm'),    #change legend key height
legend.key.width = unit(1, 'cm'),     #change legend key width
legend.title = element_text(size=34), #change legend title font size
legend.text = element_text(size=30),  #change legend text font size
legend.position = "none")       #change legend position
areadist_oc_pres_ntz_plot
#plot the area distance interaction position=position_jitterdodge(dodge.width = 1)
areadist_oc_pres_ntz_plot<- ggplot(pdat, aes(x = dist, y = fit, fill=size, color=size))+
geom_line() +
geom_ribbon(aes(ymin=fit-se.fit, ymax=fit+se.fit), alpha=0.4)+
geom_point(data = gdat.isl.ntz,aes(x=dist,y=presence, color=areasize, fill=size),alpha=0.4,show.legend = FALSE)+
theme_minimal()+
labs(y="Probability of N-fixing plant species")+
xlab("Distance [km]")+
theme(axis.text.y=element_text(size=30))+
theme(axis.text.x=element_text(size=30))+
theme(axis.title.y=element_text(size=30))+
theme(axis.title.x=element_text(size=30))+
colo+
filo+
ylim(0,1)+
theme(legend.key.size = unit(1, 'cm'),      #change legend key size
legend.key.height = unit(1, 'cm'),    #change legend key height
legend.key.width = unit(1, 'cm'),     #change legend key width
legend.title = element_text(size=34), #change legend title font size
legend.text = element_text(size=30),  #change legend text font size
legend.position = "none")       #change legend position
areadist_oc_pres_ntz_plot
#plot the area distance interaction position=position_jitterdodge(dodge.width = 1)
areadist_oc_pres_ntz_plot<- ggplot(pdat, aes(x = dist, y = fit, fill=size, color=size))+
geom_line() +
geom_ribbon(aes(ymin=fit-se.fit, ymax=fit+se.fit), alpha=0.4)+
geom_point(data = gdat.isl.ntz,aes(x=dist,y=presence, color=areasize, fill=size),alpha=0.4,show.legend = FALSE)+
theme_minimal()+
labs(y="Probability of N-fixing plant species")+
xlab("Distance [km]")+
theme(axis.text.y=element_text(size=30))+
theme(axis.text.x=element_text(size=30))+
theme(axis.title.y=element_text(size=30))+
theme(axis.title.x=element_text(size=30))+
colo+
filo+
ylim(0,1)+
theme(legend.key.size = unit(1, 'cm'),      #change legend key size
legend.key.height = unit(1, 'cm'),    #change legend key height
legend.key.width = unit(1, 'cm'),     #change legend key width
legend.title = element_text(size=34), #change legend title font size
legend.text = element_text(size=30),  #change legend text font size
legend.position =  c(0.2, 0.85))       #change legend position
areadist_oc_pres_ntz_plot
#plot the area distance interaction position=position_jitterdodge(dodge.width = 1)
areadist_oc_pres_ntz_plot<- ggplot(pdat, aes(x = dist, y = fit, fill=size, color=size))+
geom_line(show.legend=TRUE) +
geom_ribbon(aes(ymin=fit-se.fit, ymax=fit+se.fit), alpha=0.4, show.legend = TRUE)+
geom_point(data = gdat.isl.ntz,aes(x=dist,y=presence, color=areasize, fill=size),alpha=0.4,show.legend = FALSE)+
theme_minimal()+
labs(y="Probability of N-fixing plant species")+
xlab("Distance [km]")+
theme(axis.text.y=element_text(size=30))+
theme(axis.text.x=element_text(size=30))+
theme(axis.title.y=element_text(size=30))+
theme(axis.title.x=element_text(size=30))+
colo+
filo+
ylim(0,1)+
theme(legend.key.size = unit(1, 'cm'),      #change legend key size
legend.key.height = unit(1, 'cm'),    #change legend key height
legend.key.width = unit(1, 'cm'),     #change legend key width
legend.title = element_text(size=34), #change legend title font size
legend.text = element_text(size=30),  #change legend text font size
legend.position =  c(0.2, 0.85))       #change legend position
areadist_oc_pres_ntz_plot
#plot the area distance interaction position=position_jitterdodge(dodge.width = 1)
areadist_oc_pres_ntz_plot<- ggplot(pdat, aes(x = dist, y = fit, fill=size, color=size))+
geom_line() +
geom_ribbon(aes(ymin=fit-se.fit, ymax=fit+se.fit), alpha=0.4)+
geom_point(data = gdat.isl.ntz,aes(x=dist,y=presence, color=areasize, fill=size),alpha=0.4,show.legend = FALSE)+
theme_minimal()+
labs(y="Probability of N-fixing plant species")+
xlab("Distance [km]")+
theme(axis.text.y=element_text(size=30))+
theme(axis.text.x=element_text(size=30))+
theme(axis.title.y=element_text(size=30))+
theme(axis.title.x=element_text(size=30))+
colo+
filo+
ylim(0,1)+
theme(legend.key.size = unit(1, 'cm'),      #change legend key size
legend.key.height = unit(1, 'cm'),    #change legend key height
legend.key.width = unit(1, 'cm'),     #change legend key width
legend.title = element_text(size=34), #change legend title font size
legend.text = element_text(size=30),  #change legend text font size
legend.position =  c(0.2, 0.85))       #change legend position
areadist_oc_pres_ntz_plot
#plot the area distance interaction position=position_jitterdodge(dodge.width = 1)
areadist_oc_pres_ntz_plot<- ggplot(pdat, aes(x = dist, y = fit, fill=size, color=size))+
geom_line() +
geom_ribbon(aes(ymin=fit-se.fit, ymax=fit+se.fit), alpha=0.4)+
geom_point(data = gdat.isl.ntz,aes(x=dist,y=presence, color=areasize, fill=size),alpha=0.4,show.legend = FALSE)+
theme_minimal()+
labs(y="Probability of N-fixing plant species")+
xlab("Distance [km]")+
theme(axis.text.y=element_text(size=30))+
theme(axis.text.x=element_text(size=30))+
theme(axis.title.y=element_text(size=30))+
theme(axis.title.x=element_text(size=30))+
colo+
filo+
ylim(0,1)+
guides(color = guide_legend(title = "Size/Area", override.aes = list(fill = NA)))+
theme(legend.key.size = unit(1, 'cm'),      #change legend key size
legend.key.height = unit(1, 'cm'),    #change legend key height
legend.key.width = unit(1, 'cm'),     #change legend key width
legend.title = element_text(size=34), #change legend title font size
legend.text = element_text(size=30),  #change legend text font size
legend.position =  c(0.2, 0.85))       #change legend position
areadist_oc_pres_ntz_plot
#plot the area distance interaction position=position_jitterdodge(dodge.width = 1)
areadist_oc_pres_ntz_plot<- ggplot(pdat, aes(x = dist, y = fit, fill=size, color=size))+
geom_line() +
geom_ribbon(aes(ymin=fit-se.fit, ymax=fit+se.fit), alpha=0.4)+
geom_point(data = gdat.isl.ntz,aes(x=dist,y=presence, color=areasize, fill=size),alpha=0.4,show.legend = FALSE)+
theme_minimal()+
labs(y="Probability of N-fixing plant species")+
xlab("Distance [km]")+
theme(axis.text.y=element_text(size=30))+
theme(axis.text.x=element_text(size=30))+
theme(axis.title.y=element_text(size=30))+
theme(axis.title.x=element_text(size=30))+
colo+
filo+
ylim(0,1)+
guides(
color = guide_legend(title = "Size", override.aes = list(fill = NA)),  # Combine legends for color
fill = guide_legend(title = "Size")  # Ensure the fill legend is kept for color
) +
theme(legend.key.size = unit(1, 'cm'),      #change legend key size
legend.key.height = unit(1, 'cm'),    #change legend key height
legend.key.width = unit(1, 'cm'),     #change legend key width
legend.title = element_text(size=34), #change legend title font size
legend.text = element_text(size=30),  #change legend text font size
legend.position =  c(0.2, 0.85))       #change legend position
areadist_oc_pres_ntz_plot
colo<-scale_color_manual(values = c("small" = "darkred", "medium" = "brown2", "large" = "coral"))
filo<-scale_fill_manual(values = c("small" = "darkred", "medium" = "brown2", "large" = "coral"))
#plot the area distance interaction position=position_jitterdodge(dodge.width = 1)
areadist_oc_pres_ntz_plot<- ggplot(pdat, aes(x = dist, y = fit, fill=size, color=size))+
geom_line() +
geom_ribbon(aes(ymin=fit-se.fit, ymax=fit+se.fit), alpha=0.4)+
geom_point(data = gdat.isl.ntz,aes(x=dist,y=presence, color=areasize, fill=areasize),alpha=0.4,show.legend = FALSE)+
theme_minimal()+
labs(y="Probability of N-fixing plant species")+
xlab("Distance [km]")+
theme(axis.text.y=element_text(size=30))+
theme(axis.text.x=element_text(size=30))+
theme(axis.title.y=element_text(size=30))+
theme(axis.title.x=element_text(size=30))+
colo+
filo+
ylim(0,1)+
guides(
color = guide_legend(title = "Size", override.aes = list(fill = NA)),  # Combine legends for color
fill = guide_legend(title = "Size")  # Ensure the fill legend is kept for color
) +
theme(legend.key.size = unit(1, 'cm'),      #change legend key size
legend.key.height = unit(1, 'cm'),    #change legend key height
legend.key.width = unit(1, 'cm'),     #change legend key width
legend.title = element_text(size=34), #change legend title font size
legend.text = element_text(size=30),  #change legend text font size
legend.position =  c(0.2, 0.85))       #change legend position
areadist_oc_pres_ntz_plot
#plot the area distance interaction position=position_jitterdodge(dodge.width = 1)
areadist_oc_pres_ntz_plot<- ggplot(pdat, aes(x = dist, y = fit, fill=size, color=size))+
geom_line() +
geom_ribbon(aes(ymin=fit-se.fit, ymax=fit+se.fit), alpha=0.4)+
geom_point(data = gdat.isl.ntz,aes(x=dist,y=presence, color=areasize, fill=areasize),alpha=0.4,show.legend = FALSE)+
theme_minimal()+
labs(y="Probability of N-fixing plant species")+
xlab("Distance [km]")+
theme(axis.text.y=element_text(size=30))+
theme(axis.text.x=element_text(size=30))+
theme(axis.title.y=element_text(size=30))+
theme(axis.title.x=element_text(size=30))+
colo+
filo+
ylim(0,1)+
guides(
color = guide_legend(title = "Size", override.aes = list(fill = NA)),  # Combine color legend
fill = guide_legend(title = "Size")  # Ensure fill uses the same legend title
) +
theme(legend.key.size = unit(1, 'cm'),      #change legend key size
legend.key.height = unit(1, 'cm'),    #change legend key height
legend.key.width = unit(1, 'cm'),     #change legend key width
legend.title = element_text(size=34), #change legend title font size
legend.text = element_text(size=30),  #change legend text font size
legend.position =  c(0.2, 0.85))       #change legend position
areadist_oc_pres_ntz_plot
#plot the area distance interaction position=position_jitterdodge(dodge.width = 1)
areadist_oc_pres_ntz_plot<- ggplot(pdat, aes(x = dist, y = fit, fill=size, color=size))+
geom_line() +
geom_ribbon(aes(ymin=fit-se.fit, ymax=fit+se.fit), alpha=0.4)+
geom_point(data = gdat.isl.ntz,aes(x=dist,y=presence, color=areasize, fill=areasize),alpha=0.4,show.legend = FALSE)+
theme_minimal()+
labs(y="Probability of N-fixing plant species")+
xlab("Distance [km]")+
theme(axis.text.y=element_text(size=30))+
theme(axis.text.x=element_text(size=30))+
theme(axis.title.y=element_text(size=30))+
theme(axis.title.x=element_text(size=30))+
colo+
filo+
ylim(0,1)+
guides(
color = guide_legend(title = "Size"),  # Combine color legend
fill = guide_legend(title = "Size")  # Ensure fill uses the same legend title
) +
theme(legend.key.size = unit(1, 'cm'),      #change legend key size
legend.key.height = unit(1, 'cm'),    #change legend key height
legend.key.width = unit(1, 'cm'),     #change legend key width
legend.title = element_text(size=34), #change legend title font size
legend.text = element_text(size=30),  #change legend text font size
legend.position =  c(0.2, 0.85))       #change legend position
areadist_oc_pres_ntz_plot
#plot the area distance interaction position=position_jitterdodge(dodge.width = 1)
areadist_oc_pres_ntz_plot<- ggplot(pdat, aes(x = dist, y = fit, fill=size, color=size))+
geom_line() +
geom_ribbon(aes(ymin=fit-se.fit, ymax=fit+se.fit), alpha=0.4)+
geom_point(data = gdat.isl.ntz,aes(x=dist,y=presence, color=areasize, fill=areasize),alpha=0.4,show.legend = FALSE)+
theme_minimal()+
labs(y="Probability of N-fixing plant species")+
xlab("Distance [km]")+
theme(axis.text.y=element_text(size=30))+
theme(axis.text.x=element_text(size=30))+
theme(axis.title.y=element_text(size=30))+
theme(axis.title.x=element_text(size=30))+
colo+
filo+
ylim(0,1)+
guides(
color = guide_legend(title = ""),  # Combine color legend
fill = guide_legend(title = "")  # Ensure fill uses the same legend title
) +
theme(legend.key.size = unit(1, 'cm'),      #change legend key size
legend.key.height = unit(1, 'cm'),    #change legend key height
legend.key.width = unit(1, 'cm'),     #change legend key width
legend.title = element_text(size=34), #change legend title font size
legend.text = element_text(size=30),  #change legend text font size
legend.position =  c(0.2, 0.85))       #change legend position
areadist_oc_pres_ntz_plot
# Add size column with custom breakpoints
gdat.isl.ntz$areasize <- cut(gdat.isl.ntz$area,
breaks = breakpoints,
labels = c("small", "medium", "large"))
gdat.isl.ntz$areasize <- factor(gdat.isl.ntz$areasize, levels = c("large", "medium", "small"))
colo<-scale_color_manual(values = c("small" = "darkred", "medium" = "brown2", "large" = "coral"))
filo<-scale_fill_manual(values = c("small" = "darkred", "medium" = "brown2", "large" = "coral"))
#plot the area distance interaction position=position_jitterdodge(dodge.width = 1)
areadist_oc_pres_ntz_plot<- ggplot(pdat, aes(x = dist, y = fit, fill=size, color=size))+
geom_line() +
geom_ribbon(aes(ymin=fit-se.fit, ymax=fit+se.fit), alpha=0.4)+
geom_point(data = gdat.isl.ntz,aes(x=dist,y=presence, color=areasize, fill=areasize),alpha=0.4,show.legend = FALSE)+
theme_minimal()+
labs(y="Probability of N-fixing plant species")+
xlab("Distance [km]")+
theme(axis.text.y=element_text(size=30))+
theme(axis.text.x=element_text(size=30))+
theme(axis.title.y=element_text(size=30))+
theme(axis.title.x=element_text(size=30))+
colo+
filo+
ylim(0,1)+
guides(
color = guide_legend(title = ""),  # Combine color legend
fill = guide_legend(title = "")  # Ensure fill uses the same legend title
) +
theme(legend.key.size = unit(1, 'cm'),      #change legend key size
legend.key.height = unit(1, 'cm'),    #change legend key height
legend.key.width = unit(1, 'cm'),     #change legend key width
legend.title = element_text(size=34), #change legend title font size
legend.text = element_text(size=30),  #change legend text font size
legend.position =  c(0.2, 0.85))       #change legend position
areadist_oc_pres_ntz_plot
#Saving the plot as a png
png("figures/M3_areadist_interaction.jpg", width=10, height= 10, units='in', res=300)
areadist_oc_pres_ntz_plot
dev.off()
dev.off()
oc_pres_native_dist_plot<-ggplot(pred.ml, aes(x = dist, y = fit))+
geom_line(color="darkcyan") +
geom_ribbon(aes(ymin=fit-se.fit, ymax=fit+se.fit), alpha=0.4,color="darkcyan", fill="darkcyan")+
geom_point(data = gdat.isl.ntv,aes(x=dist,y=presence, color="darkcyan", fill="darkcyan"),alpha=0.4,show.legend = FALSE)+
theme_minimal()+
labs(y="Probability of N-fixing plants")+
xlab("Distance [km]")+
theme(axis.text.y=element_text(size=30))+
theme(axis.text.x=element_text(size=30))+
theme(axis.title.y=element_text(size=30))+
theme(axis.title.x=element_text(size=30))
oc_pres_native_dist_plot
#distance plot
new.dat.oc <- with(oceanic.pres.ntv, expand.grid(dist = seq(min(dist), max(dist), length = 1000))) %>%
mutate(rac = mean(rac), abs.lat= mean(oceanic.pres.ntv$abs.lat), area=mean(oceanic.pres.ntv$area), temperature= mean(oceanic.pres.ntv$temperature), precipitation=mean(oceanic.pres.ntv$precipitation)) #CREATE range for area from min to max value
pred.ml <- predict(model.oc.pres.rac, newdata = new.dat.oc, type = "response", se = TRUE) %>% # create new dataframe where area changes and all other variables are kept on mean
as.data.frame() %>%
mutate(dist = new.dat.oc$dist, landtype = "oceanic")
oc_pres_native_dist_plot<-ggplot(pred.ml, aes(x = dist, y = fit))+
geom_line(color="darkcyan") +
geom_ribbon(aes(ymin=fit-se.fit, ymax=fit+se.fit), alpha=0.4,color="darkcyan", fill="darkcyan")+
geom_point(data = gdat.isl.ntv,aes(x=dist,y=presence, color="darkcyan", fill="darkcyan"),alpha=0.4)+
theme_minimal()+
labs(y="Probability of N-fixing plants")+
xlab("Distance [km]")+
theme(axis.text.y=element_text(size=30))+
theme(axis.text.x=element_text(size=30))+
theme(axis.title.y=element_text(size=30))+
theme(axis.title.x=element_text(size=30))
oc_pres_native_dist_plot
oc_pres_native_dist_plot<-ggplot(pred.ml, aes(x = dist, y = fit))+
geom_line(color="darkcyan") +
geom_ribbon(aes(ymin=fit-se.fit, ymax=fit+se.fit), alpha=0.4,color="darkcyan", fill="darkcyan")+
geom_point(data = gdat.isl.ntv,aes(x=dist,y=presence) color="darkcyan", fill="darkcyan",alpha=0.4)+
oc_pres_native_dist_plot<-ggplot(pred.ml, aes(x = dist, y = fit))+
geom_line(color="darkcyan") +
geom_ribbon(aes(ymin=fit-se.fit, ymax=fit+se.fit), alpha=0.4,color="darkcyan", fill="darkcyan")+
geom_point(data = gdat.isl.ntv,aes(x=dist,y=presence), color="darkcyan", fill="darkcyan",alpha=0.4)+
theme_minimal()+
labs(y="Probability of N-fixing plants")+
xlab("Distance [km]")+
theme(axis.text.y=element_text(size=30))+
theme(axis.text.x=element_text(size=30))+
theme(axis.title.y=element_text(size=30))+
theme(axis.title.x=element_text(size=30))
oc_pres_native_dist_plot
oc_pres_native_dist_plot<-ggplot(pred.ml, aes(x = dist, y = fit))+
geom_line(color="darkcyan") +
geom_ribbon(aes(ymin=fit-se.fit, ymax=fit+se.fit), alpha=0.3,color="darkcyan", fill="darkcyan")+
geom_point(data = gdat.isl.ntv,aes(x=dist,y=presence), color="darkcyan", fill="darkcyan",alpha=0.4)+
theme_minimal()+
labs(y="Probability of N-fixing plants")+
xlab("Distance [km]")+
theme(axis.text.y=element_text(size=30))+
theme(axis.text.x=element_text(size=30))+
theme(axis.title.y=element_text(size=30))+
theme(axis.title.x=element_text(size=30))
oc_pres_native_dist_plot
#Saving the plot as a png
png("figures/M5_dist_oc_pres_ntvpoints.jpg", width=10, height= 10, units='in', res=300)
oc_pres_native_dist_plot
dev.off()
dev.off()
oc_pres_native_dist_plot<-ggplot(pred.ml, aes(x = dist, y = fit))+
geom_line(color="darkcyan") +
geom_ribbon(aes(ymin=fit-se.fit, ymax=fit+se.fit), alpha=0.3,color="darkcyan", fill="darkcyan")+
geom_point(data = gdat.isl.ntv,aes(x=dist,y=presence), color="darkcyan", fill="darkcyan",alpha=0.4)+
theme_minimal()+
labs(y="Probability of N-fixing plants")+
xlab("Distance [km]")+
theme(axis.text.y=element_text(size=30))+
theme(axis.text.x=element_text(size=30))+
theme(axis.title.y=element_text(size=30))+
theme(axis.title.x=element_text(size=30),margin = margin(t = 20))
oc_pres_native_dist_plot
oc_pres_native_dist_plot<-ggplot(pred.ml, aes(x = dist, y = fit))+
geom_line(color="darkcyan") +
geom_ribbon(aes(ymin=fit-se.fit, ymax=fit+se.fit), alpha=0.3,color="darkcyan", fill="darkcyan")+
geom_point(data = gdat.isl.ntv,aes(x=dist,y=presence), color="darkcyan", fill="darkcyan",alpha=0.4)+
theme_minimal()+
labs(y="Probability of N-fixing plants")+
xlab("Distance [km]")+
theme(axis.text.y=element_text(size=30))+
theme(axis.text.x=element_text(size=30))+
theme(axis.title.y=element_text(size=30))+
theme(axis.title.x=element_text(size=30),margin = margin(t = 3))
oc_pres_native_dist_plot
oc_pres_native_dist_plot<-ggplot(pred.ml, aes(x = dist, y = fit))+
geom_line(color="darkcyan") +
geom_ribbon(aes(ymin=fit-se.fit, ymax=fit+se.fit), alpha=0.3,color="darkcyan", fill="darkcyan")+
geom_point(data = gdat.isl.ntv,aes(x=dist,y=presence), color="darkcyan", fill="darkcyan",alpha=0.4)+
theme_minimal()+
labs(y="Probability of N-fixing plants")+
xlab("Distance [km]")+
theme(axis.text.y=element_text(size=30))+
theme(axis.text.x=element_text(size=30))+
theme(axis.title.y=element_text(size=30))+
theme(axis.title.x=element_text(size=30,margin = margin(t = 10)))
oc_pres_native_dist_plot
#Saving the plot as a png
png("figures/M5_dist_oc_pres_ntvpoints.jpg", width=10, height= 10, units='in', res=300)
oc_pres_native_dist_plot
dev.off()
dev.off()
#plot the area distance interaction position=position_jitterdodge(dodge.width = 1)
areadist_oc_pres_ntz_plot<- ggplot(pdat, aes(x = dist, y = fit, fill=size, color=size))+
geom_line() +
geom_ribbon(aes(ymin=fit-se.fit, ymax=fit+se.fit), alpha=0.4)+
geom_point(data = gdat.isl.ntz,aes(x=dist,y=presence, color=areasize, fill=areasize),alpha=0.4,show.legend = FALSE)+
theme_minimal()+
labs(y="Probability of N-fixing plant species")+
xlab("Distance [km]")+
theme(axis.text.y=element_text(size=30))+
theme(axis.text.x=element_text(size=30))+
theme(axis.title.y=element_text(size=30))+
theme(axis.title.x=element_text(size=30,margin = margin(t = 10)))+
colo+
filo+
ylim(0,1)+
guides(
color = guide_legend(title = ""),  # Combine color legend
fill = guide_legend(title = "")  # Ensure fill uses the same legend title
) +
theme(legend.key.size = unit(1, 'cm'),      #change legend key size
legend.key.height = unit(1, 'cm'),    #change legend key height
legend.key.width = unit(1, 'cm'),     #change legend key width
legend.title = element_text(size=34), #change legend title font size
legend.text = element_text(size=30),  #change legend text font size
legend.position =  c(0.2, 0.85))       #change legend position
areadist_oc_pres_ntz_plot
#Saving the plot as a png
png("figures/M3_areadist_interactionpoints.jpg", width=10, height= 10, units='in', res=300)
areadist_oc_pres_ntz_plot
dev.off()
dev.off()
#plot the area distance interaction position=position_jitterdodge(dodge.width = 1)
areadist_oc_pres_ntz_plot<- ggplot(pdat, aes(x = dist, y = fit, fill=size, color=size))+
geom_line() +
geom_ribbon(aes(ymin=fit-se.fit, ymax=fit+se.fit), alpha=0.4)+
#geom_point(data = gdat.isl.ntz,aes(x=dist,y=presence, color=areasize, fill=areasize),alpha=0.4,show.legend = FALSE)+
theme_minimal()+
labs(y="Probability of N-fixing plant species")+
xlab("Distance [km]")+
theme(axis.text.y=element_text(size=30))+
theme(axis.text.x=element_text(size=30))+
theme(axis.title.y=element_text(size=30))+
theme(axis.title.x=element_text(size=30,margin = margin(t = 10)))+
colo+
filo+
ylim(0,1)+
guides(
color = guide_legend(title = ""),  # Combine color legend
fill = guide_legend(title = "")  # Ensure fill uses the same legend title
) +
theme(legend.key.size = unit(1, 'cm'),      #change legend key size
legend.key.height = unit(1, 'cm'),    #change legend key height
legend.key.width = unit(1, 'cm'),     #change legend key width
legend.title = element_text(size=34), #change legend title font size
legend.text = element_text(size=30),  #change legend text font size
legend.position =  c(0.2, 0.85))       #change legend position
areadist_oc_pres_ntz_plot
#Saving the plot as a png
png("figures/M3_areadist_interaction.jpg", width=10, height= 10, units='in', res=300)
areadist_oc_pres_ntz_plot
dev.off()
dev.off()
#plot the area distance interaction position=position_jitterdodge(dodge.width = 1)
areadist_oc_pres_ntz_plot<- ggplot(pdat, aes(x = dist, y = fit, fill=size, color=size))+
geom_line() +
geom_ribbon(aes(ymin=fit-se.fit, ymax=fit+se.fit), alpha=0.4)+
#geom_point(data = gdat.isl.ntz,aes(x=dist,y=presence, color=areasize, fill=areasize),alpha=0.4,show.legend = FALSE)+
theme_minimal()+
labs(y="Probability of N-fixing plant species")+
xlab("Distance [km]")+
theme(axis.text.y=element_text(size=30))+
theme(axis.text.x=element_text(size=30))+
theme(axis.title.y=element_text(size=30))+
theme(axis.title.x=element_text(size=30,margin = margin(t = 10)))+
colScale+
fillScale+
ylim(0,1)+
guides(
color = guide_legend(title = ""),  # Combine color legend
fill = guide_legend(title = "")  # Ensure fill uses the same legend title
) +
theme(legend.key.size = unit(1, 'cm'),      #change legend key size
legend.key.height = unit(1, 'cm'),    #change legend key height
legend.key.width = unit(1, 'cm'),     #change legend key width
legend.title = element_text(size=34), #change legend title font size
legend.text = element_text(size=30),  #change legend text font size
legend.position =  c(0.2, 0.85))       #change legend position
areadist_oc_pres_ntz_plot
